%h1 Locations
- pre_selection = params[:locations]||[]
= form_tag(ENV["pre_fix_url"]+"/place_bulk_order", method: :post) do 
  = hidden_field_tag "action_type", "save-location-list"
  - (params[:products]||[]).each do |v|
    = hidden_field_tag "products[]", v
  %table.table.table-striped
    %thead
      %tr
        %th #
        %th Location
        %th Address
        %th City
        %th Actions
    %tbody
      - @distributors.each do |distributor|
        - if distributor.addresses[0].present?
          %tr
            %td= check_box_tag  'distributors[]', distributor.id, pre_selection.include?(distributor.id.to_s), class: 'distributor'
            %td= "#{distributor.addresses[0].first_name} #{distributor.addresses[0].last_name}"
            %td= distributor.addresses.present? ? "#{distributor.addresses[0].address1}" : "N/A"
            %td= distributor.addresses.present? ? distributor.addresses[0].city : "N/A" 
            %td= link_to 'Edit', ENV["pre_fix_url"]+place_bulk_order_path(action_type: 'edit-location', id: distributor.id, locations: session[:bulk_order]['distributors']||[], products: session[:bulk_order]['products']||[])
  = submit_tag 'Save Locations for bulk order' ,class: 'btn btn-primary update-distributor'
%br

= link_to 'New Location', ENV["pre_fix_url"]+place_bulk_order_path(action_type: 'new-location', locations: session[:bulk_order]['distributors']||[], products: session[:bulk_order]['products']||[]) , class: 'btn btn-success'
=# link_to 'Sync from Shop', sync_distributors_path ,class: 'btn btn-success'